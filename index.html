<!DOCTYPE html>
<html lang="en">
  <head>
    <!--
      Reading this? Looking for an awesome software developer? You might want to check out
      sdufresne.info/cv :-)
    -->
    <title>Stefan du Fresne - Software Developer, Imagineer and general human</title>
    <meta name="description" content="Personal homepage of Stefan du Fresne, software developer aka software engineer aka code craftsman aka software imagineer." />
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style type="text/css">
      /* normal screens */
      img#avatar {
        /* This calculates to ~307 across: 30% (#contact width) of 1024 */
        max-width: 100%;
      }

      #site-wrapper {
        max-width: 1024px;
        font-size: 175%;
        line-height: 3ex;
        padding-right: 1em;
        padding-left: 1em;
        margin: 0 auto;
      }

      #spiel {
        float: left;
        width: 60%;
      }
      #contact {
        width: 30%;
        float: right;
      }

      /* anti-spam */
      .email-address {
        unicode-bidi: bidi-override;
        direction: rtl;
      }

      /* actual styling */
      body {
        font-family: "Helvetica", "Arial", sans-serif;
        font-weight: 100;
        color: #333;
      }

      .greeting {
        font-family: "Helvetica", "Arial", sans-serif;
        font-weight: 100;
        line-height: 2ex;
      }

      .clickable {
        cursor: pointer;
      }

      #spiel .clickable,
      #spiel a {
        display: inline-block;
        transition: all .1s;
      }

      .clickable, a, a:visited, a:hover, a:active {
        font-weight: bold;
        text-decoration: none;
        color: #333;
        background-color: #FFEFEF;
        margin: -0.125em;
        padding: 0.125em;
      }
      #spiel .clickable:hover,
      #spiel a:hover {
        color: #FFEFEF;
        background-color: #A00;

        -webkit-transform: rotateZ(-1deg);
        -ms-transform: rotateZ(-1deg);
        transform: rotateZ(-1deg);
      }

      .smash {
        transition: all .1s;
      }
      .smash:hover {
        -webkit-transform: rotateZ(1deg) !important;
        -ms-transform: rotateZ(1deg) !important;
        transform: rotateZ(1deg) !important;
      }

      @media (hover: none) {
        #spiel .clickable:hover,
        #spiel a:hover {
          /* TODO: Do I have to repeat myself here? */
          color: #333;
          background-color: #FFEFEF;

          -webkit-transform: initial;
          -ms-transform: initial;
          transform: initial;
        }
      }

      #contact a,
      #contact a:visited,
      #contact a:hover,
      #contact a:active {
        font-weight: inherit;
        color: #406CB6;
        background-color: inherit;
      }
      #contact a:hover {
        color: red;
      }

      #contact {
        font-size: 80%;
        line-height: 2.5ex;
      }

      #contact ul {
        padding-left: 0;
      }

      #contact li {
        list-style-type: none;
        overflow: hidden;
      }

      #minor-contacts {
        font-size: 80%;
      }

      /* smaller screens */
      @media screen and (max-width: 760px) {

        /* easier to read */
        body, .greeting {
          font-weight: normal;
        }

        img {
          display: none;
        }

        #site-wrapper {
          padding: 0;
          margin: 0;
          padding-top: 0.5em;
          overflow: auto;
          position: relative;
        }
        #site-wrapper:before {
          content: "";
          position: fixed;
          left: 0;
          right: 0;
          top: 0;
          margin: 0;
          padding: 0;
          z-index: -1;

          display: block;
          background-image: url("./assets/img/actually-me-2015-1x.jpg");
          background: -webkit-image-set( url(./assets/img/actually-me-2015-1x.jpg) 1x, url(./assets/img/actually-me-2015-2x.jpg) 2x );
          background-size: cover;
          background-position: center top;
          background-repeat: no-repeat;
          width: 100%;
          height: 100%;

          -webkit-filter: grayscale(60%);
          -moz-filter: grayscale(60%);
          -o-filter: grayscale(60%);
          -ms-filter: grayscale(60%);
          filter: grayscale(60%);
        }
        #contact {
          padding: 1em 0;
          background-color: white;
          float: none;
          width: 100%;
          /* shamelessly stolen from bootstrap */
          -webkit-border-radius: 3px;
             -moz-border-radius: 3px;
                  border-radius: 3px;
        }
        #contact hr {
          display: none;
        }
        #major-contacts {
          float: left;
          padding-left: 1em !important;
          width: 60%;
          margin: 0;
          line-height: 3ex;
        }

        #minor-contacts {
          float: right;
          width: 30%;
          margin: 0;
        }
        #sigh {
          clear: both;
        }
        #spiel {
          float: none;
          width: inherit;
          margin: 0.5em;
          margin-top: 0;
          padding: 1em;
          padding-top: 0;
          background-color: white;
          background-color: rgba(255,255,255, 0.95);

          z-index: 9999;

          /* shamelessly stolen from bootstrap */
          border: 1px solid #e3e3e3;
          -webkit-border-radius: 5px;
             -moz-border-radius: 5px;
                  border-radius: 5px;
          -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
             -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
                  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
        }
      }
      /* Desktop font sizes */
      @media screen and (max-width: 1000px) {
        #site-wrapper {
          font-size: 150%;
        }
      }
      @media screen and (max-width: 900px) {
        #site-wrapper {
          font-size: 135%;
        }
      }
      /* Now mobile sheet */
      @media screen and (max-width: 760px) {
        #site-wrapper {
          font-size: 150%;
        }
      }
      @media screen and (max-width: 600px) {
        #site-wrapper {
          font-size: 110%;
        }
      }
      @media screen and (max-width: 420px) {
        #site-wrapper {
          font-size: 100%;
        }
      }
      @media screen and (max-width: 380px) {
        #site-wrapper {
          font-size: 95%;
        }
      }
      @media screen and (max-width: 360px) {
        #site-wrapper {
          font-size: 85%;
        }
      }
    </style>
  </head>
  <body>
    <main id="site-wrapper">
      <div id="spiel"><!-- ;-) -->
        <h1 class="greeting" id="greeting">Hello,</h1>
        <h2 class="greeting">My name is Stefan du Fresne</h2>
        <p>I'm <span id="aan">a</span> <span id="job-title" class="js-clickable">software developer</span> from New Zealand. I currently live in London.</p>
        <p>Over the last <span id="career-length">few years</span> I've helped to build a reasonably large amount of software. Some of it works!</p>
        <p>Currently I'm helping <a href="http://medicmobile.org">these delightful folk</a> build mobile health tools for remote regions.</p>
        <p>We use Angular, Node.js and all the hipster tech. Functional programming&mdash;Scala and Clojure especially&mdash;is cool too. Whatever works.</p>
        <p>Sometimes I take bad photos of things and fiddle with them on computers.</p>
        <p>I often go by SCdF on the Internet.</p>
      </div>
      <div id="contact">
        <img
          id="avatar"
          alt="Picture of Stefan du Fresne"
          src="./assets/img/actually-me-2015-1x.jpg"
          srcset="./assets/img/actually-me-2015-1x.jpg 1x, ./assets/img/actually-me-2015-2x.jpg 2x">
        <ul id="major-contacts">
          <li><span class="email-address">ofni.enserfuds@nafets</span></li>
          <li><a href="https://keybase.io/scdf">Keybase</a></li>
          <li><a href="https://github.com/SCdF/">Github</a></li>
        </ul>
        <hr>
        <ul id="minor-contacts">
          <li><a href="http://stackoverflow.com/users/1666/scdf">StackOverflow</a></li>
          <li><a href="https://news.ycombinator.com/user?id=SCdF">HackerNews</a></li>
          <li><a href="http://nz.linkedin.com/pub/stefan-du-fresne/47/687/797">LinkedIn</a></li>
          <li><a href="https://twitter.com/_SCdF_">Twitter</a></li>
          <li><a href="https://www.flickr.com/photos/stefandufresne/">Flickr</a></li>
        </ul>
        <div id="sigh"></div>
      </div>
      <script type="text/javascript">
      /* jshint browser: true */
      (function() {
        'use strict';

        var sdufresne = {
          greeting: function() {
            var hours = new Date().getHours();
            switch (true) {
              case (hours < 12): return 'Good Morning';
              case (hours < 18): return 'Good Afternoon';
              default: return 'Good Evening';
            }
          },

          reverse: function(s) {
            return s.split('').reverse().join('');
          },

          randArray: function(array) {
            return array[Math.floor(Math.random()*array.length)]
          },

          // I'm a <XXX> from New Zeaâ€¦
          title: function(current) {
            current = current && current.display;

            var jobTitles = [
              'software developer',
              'developer',
              'coder',
              'programmer',
              ];

            var allJobTitles = jobTitles.concat([
              '(defn stefan [] (fn[work] (do-work work)))',
              'architect of your dreams',
              'artisan software sculptor',
              'beard horticulturalist',
              'beard horticulturist',
              'big fan of yours',
              'code craftsman',
              'code costermonger',
              'code monkey',
              'code-typhoon',
              'gentle code crooner',
              'good enough dev for govenment work',
              'greatly enlarged micro-organsim',
              'large font aficionado',
              'meme wrangler',
              'non-brogrammer programmer',
              'rabid archillect fan',
              'software craftsman',
              'software imagineer',
              'software witch',
              'software "engineer"',
              'thoroughly average programmer',
            ]);

            var potentialTitles = (function() {
              if (current) {
                var titles = Object.values(allJobTitles);
                titles.splice(allJobTitles.indexOf(current), 1);
                return titles;
              } else {
                return jobTitles;
              }
            })();

            return {
              display: sdufresne.randArray(potentialTitles)
            };
          },

          article: function(currentTitle) {
            if (['a', 'e', 'i', 'o', 'u'].indexOf(currentTitle.charAt(0)) >= 0) {
              return 'an';
            } else {
              return 'a';
            }
          },

          rawCareerLength: Date.now() - Date.parse('2006-02-14'),

          stdCareerLength: function(divisor) {
            return Math.floor(sdufresne.rawCareerLength / divisor);
          },

          careerLengths: {
            years: function() {
              return sdufresne.stdCareerLength(1000 * 60 * 60 * 24 * 365) + ' years';
            },
            seconds: function() {
              return sdufresne.stdCareerLength(1000) + ' seconds';
            },
            moons: function() {
              return sdufresne.stdCareerLength(86400 * 1000) + ' moons';
            }
          },

          careerLength: function(current) {
            var careerLength = (function() {
              if (current) {
                var potentialLengths = Object.keys(sdufresne.careerLengths);
                potentialLengths.splice(potentialLengths.indexOf(current.type), 1);
                return sdufresne.randArray(potentialLengths);
              } else {
                return 'years';
              }
            })();

            return {
              display: sdufresne.careerLengths[careerLength](),
              type: careerLength
            };
          },

          beClickable: function(element, initialValueFn, clickFn) {
            clickFn = clickFn || initialValueFn;

            element.classList.add('clickable');
            var value = initialValueFn();
            element.innerHTML = initialValueFn().display;
            element.onmousedown = function(e) {
              e.preventDefault();
            }
            element.onclick = function(e) {
              element.classList.add('smash');
              window.setTimeout(function() {
                value = clickFn(value);

                element.innerHTML = value.display;

                element.classList.remove('smash');
              }, 100);
            }
          }
        };

        document.addEventListener("DOMContentLoaded", function() {
          document.getElementById('greeting').innerHTML = sdufresne.greeting();

          var clickables = document.querySelectorAll('.js-clickable');
          for (var i = 0; i < clickables.length; i++) {
            clickables[i].classList.add('clickable');
          }

          var emailEl = document.querySelector('.email-address');
          emailEl.innerHTML = '<a href="mailto:' +
            sdufresne.reverse(emailEl.innerHTML) +
            '">'+emailEl.innerHTML+'</a>';

          sdufresne.beClickable(
            document.querySelector('#career-length'),
            sdufresne.careerLength);

          sdufresne.beClickable(
            document.querySelector('#job-title'),
            sdufresne.title);

          var jobTitle = document.querySelector('#job-title');
          var titleArticle = document.querySelector('#aan');

          titleArticle.innerHTML = sdufresne.article(jobTitle.innerHTML);
          // TODO: replace with MutationObserver
          jobTitle.addEventListener ("DOMSubtreeModified", function() {
            if (jobTitle.innerHTML) {
              titleArticle.innerHTML = sdufresne.article(jobTitle.innerHTML);
            }
          });

          document.querySelector('#spiel a').onclick = function(e) {
            this.className = this.className + ' smash';
          };
        });
      })();
      </script>
    </main>
  </body>
</html>
